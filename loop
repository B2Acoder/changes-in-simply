#include "shell.h"

/**
 * process_user_input - This function processes user input
 *
 * Return: Void
 */
void process_user_input(void)
{
	char *input = user_readinput();

	if (input == NULL)
	{
		printf("\n");
		shell_exit();
	}

	if (strlen(input) > 0)
	{
		if (strcmp(input, "exit") == 0)
		{
			free(input);
			shell_exit();
		}
		execute_command(input);
	}

	free(input);
}

/**
 * process_file_input - This function processes file input
 * @fileinput: This function takes fileinput as argument
 * Return: Void
 */
void process_file_input(FILE *fileinput)
{
	char *input = read_fileinput(fileinput);

	while (input != NULL)
	{
		if (strlen(input) > 0)
		{
			execute_command(input);
		}

		free(input);
		input = read_fileinput(fileinput);
	}

	fclose(fileinput);
}

/**
 * prompt_loop - This function runs the shell's main loop
 * Return: Always 0 (Success)
 */
int prompt_loop(void)
{
	FILE *fileinput = fopen("input.txt", "r");

	while (1)
	{
		if (is_interactive_mode())
		{
			printf("Debug: Entering interactive mode\n");

			prompt_design();

			printf("Debug: Calling process_user_input()\n");

			process_user_input();
		}
		else
		{
			if (fileinput == NULL)
			{
				fprintf(stderr, "Error opening input file.\n");
				return (1);
			}

			printf("Debug: Entering non-interactive mode\n");

			process_file_input(fileinput);
		}
	}

	return (0);
}
